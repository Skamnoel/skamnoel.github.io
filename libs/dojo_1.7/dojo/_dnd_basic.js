/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

//>>built
require({cache:{"dojo/dnd/autoscroll":function(){define("dojo/dnd/autoscroll",["../main","../window"],function(_1){_1.getObject("dnd",true,_1);_1.dnd.getViewport=_1.window.getBox;_1.dnd.V_TRIGGER_AUTOSCROLL=32;_1.dnd.H_TRIGGER_AUTOSCROLL=32;_1.dnd.V_AUTOSCROLL_VALUE=16;_1.dnd.H_AUTOSCROLL_VALUE=16;_1.dnd.autoScroll=function(e){var v=_1.window.getBox(),dx=0,dy=0;if(e.clientX<_1.dnd.H_TRIGGER_AUTOSCROLL){dx=-_1.dnd.H_AUTOSCROLL_VALUE;}else{if(e.clientX>v.w-_1.dnd.H_TRIGGER_AUTOSCROLL){dx=_1.dnd.H_AUTOSCROLL_VALUE;}}if(e.clientY<_1.dnd.V_TRIGGER_AUTOSCROLL){dy=-_1.dnd.V_AUTOSCROLL_VALUE;}else{if(e.clientY>v.h-_1.dnd.V_TRIGGER_AUTOSCROLL){dy=_1.dnd.V_AUTOSCROLL_VALUE;}}window.scrollBy(dx,dy);};_1.dnd._validNodes={"div":1,"p":1,"td":1};_1.dnd._validOverflow={"auto":1,"scroll":1};_1.dnd.autoScrollNodes=function(e){var b,t,w,h,rx,ry,dx=0,dy=0,_2,_3;for(var n=e.target;n;){if(n.nodeType==1&&(n.tagName.toLowerCase() in _1.dnd._validNodes)){var s=_1.getComputedStyle(n),_4=(s.overflow.toLowerCase() in _1.dnd._validOverflow),_5=(s.overflowX.toLowerCase() in _1.dnd._validOverflow),_6=(s.overflowY.toLowerCase() in _1.dnd._validOverflow);if(_4||_5||_6){b=_1._getContentBox(n,s);t=_1.position(n,true);}if(_4||_5){w=Math.min(_1.dnd.H_TRIGGER_AUTOSCROLL,b.w/2);rx=e.pageX-t.x;if(_1.isWebKit||_1.isOpera){rx+=_1.body().scrollLeft;}dx=0;if(rx>0&&rx<b.w){if(rx<w){dx=-w;}else{if(rx>b.w-w){dx=w;}}_2=n.scrollLeft;n.scrollLeft=n.scrollLeft+dx;}}if(_4||_6){h=Math.min(_1.dnd.V_TRIGGER_AUTOSCROLL,b.h/2);ry=e.pageY-t.y;if(_1.isWebKit||_1.isOpera){ry+=_1.body().scrollTop;}dy=0;if(ry>0&&ry<b.h){if(ry<h){dy=-h;}else{if(ry>b.h-h){dy=h;}}_3=n.scrollTop;n.scrollTop=n.scrollTop+dy;}}if(dx||dy){return;}}try{n=n.parentNode;}catch(x){n=null;}}_1.dnd.autoScroll(e);};return _1.dnd;});},"dojo/dnd/Target":function(){define("dojo/dnd/Target",["./Source"],function(_7){return dojo.declare("dojo.dnd.Target",_7,{constructor:function(_8,_9){this.isSource=false;dojo.removeClass(this.node,"dojoDndSource");}});});},"dojo/dnd/common":function(){define("dojo/dnd/common",["../main"],function(_a){_a.getObject("dnd",true,_a);_a.dnd.getCopyKeyState=_a.isCopyKey;_a.dnd._uniqueId=0;_a.dnd.getUniqueId=function(){var id;do{id=_a._scopeName+"Unique"+(++_a.dnd._uniqueId);}while(_a.byId(id));return id;};_a.dnd._empty={};_a.dnd.isFormElement=function(e){var t=e.target;if(t.nodeType==3){t=t.parentNode;}return " button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0;};return _a.dnd;});},"dojo/dnd/Selector":function(){define("dojo/dnd/Selector",["../main","./common","./Container"],function(_b){_b.declare("dojo.dnd.Selector",_b.dnd.Container,{constructor:function(_c,_d){if(!_d){_d={};}this.singular=_d.singular;this.autoSync=_d.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(_b.connect(this.node,"onmousedown",this,"onMouseDown"),_b.connect(this.node,"onmouseup",this,"onMouseUp"));},singular:false,getSelectedNodes:function(){var t=new _b.NodeList();var e=_b.dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(_b.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(_e,id){this._addItemClass(_b.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=_b.dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=_b.byId(i);this.delItem(i);_b.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_b.global;var s=this.selection,e=_b.dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_b.dnd.Selector.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=_b.dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_b.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_f,_10,_11,_12){var _13=this._normalizedCreator;this._normalizedCreator=function(_14,_15){var t=_13.call(this,_14,_15);if(_f){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_b.dnd.Selector.superclass.insertNodes.call(this,_10,_11,_12);this._normalizedCreator=_13;return this;},destroy:function(){_b.dnd.Selector.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!_b.isCopyKey(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(e.button===_b.mouseButtons.LEFT){_b.stopEvent(e);}return;}if(!this.singular&&e.shiftKey){if(!_b.isCopyKey(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0;for(;i<c.length;++i){var _16=c[i];if(_16==this.anchor||_16==this.current){break;}}for(++i;i<c.length;++i){var _16=c[i];if(_16==this.anchor||_16==this.current){break;}this._addItemClass(_16,"Selected");this.selection[_16.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(_b.isCopyKey(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(_b.isCopyKey(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_b.stopEvent(e);},onMouseUp:function(e){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(e){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=_b.connect(this.node,"onmousemove",this,"onMouseMove");},onOutEvent:function(){_b.disconnect(this.onmousemoveEvent);delete this.onmousemoveEvent;},_removeSelection:function(){var e=_b.dnd._empty;for(var i in this.selection){if(i in e){continue;}var _17=_b.byId(i);if(_17){this._removeItemClass(_17,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _b.dnd.Selector;});},"dojo/dnd/AutoSource":function(){define("dojo/dnd/AutoSource",["./Source"],function(_18){return dojo.declare("dojo.dnd.AutoSource",_18,{constructor:function(_19,_1a){this.autoSync=true;}});});},"dojo/dnd/Source":function(){define("dojo/dnd/Source",["../main","./Selector","./Manager"],function(_1b,_1c,_1d){if(!_1b.isAsync){_1b.ready(0,function(){var _1e=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_1e);});}return _1b.declare("dojo.dnd.Source",_1c,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(_1f,_20){_1b.mixin(this,_1b.mixin({},_20));var _21=this.accept;if(_21.length){this.accept={};for(var i=0;i<_21.length;++i){this.accept[_21[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_1b.addClass(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_1b.addClass(this.node,"dojoDndTarget");}if(this.horizontal){_1b.addClass(this.node,"dojoDndHorizontal");}this.topics=[_1b.subscribe("/dnd/source/over",this,"onDndSourceOver"),_1b.subscribe("/dnd/start",this,"onDndStart"),_1b.subscribe("/dnd/drop",this,"onDndDrop"),_1b.subscribe("/dnd/cancel",this,"onDndCancel")];},checkAcceptance:function(_22,_23){if(this==_22){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_23.length;++i){var _24=_22.getItem(_23[i].id).type;var _25=false;for(var j=0;j<_24.length;++j){if(_24[j] in this.accept){_25=true;break;}}if(!_25){return false;}}return true;},copyState:function(_26,_27){if(_26){return true;}if(arguments.length<2){_27=this==_1d.manager().target;}if(_27){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_1b.dnd.Source.superclass.destroy.call(this);_1b.forEach(this.topics,_1b.unsubscribe);this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_1b.dnd.Source.superclass.onMouseMove.call(this,e);var m=_1d.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _28=this.getSelectedNodes();if(_28.length){m.startDrag(this,_28,this.copyState(_1b.isCopyKey(e),true));}}}if(this.isDragging){var _29=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_1b.position(this.current,true);}if(this.horizontal){_29=(e.pageX-this.targetBox.x)<(this.targetBox.w/2);}else{_29=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_29!=this.before){this._markTargetAnchor(_29);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!_1b.dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_1b.dnd.Source.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_1b.dnd.Source.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_2a){if(this!=_2a){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_1d.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_2b,_2c,_2d){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_2b?(_2d?"Copied":"Moved"):"");}var _2e=this.accept&&this.checkAcceptance(_2b,_2c);this._changeState("Target",_2e?"":"Disabled");if(this==_2b){_1d.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_2f,_30,_31,_32){if(this==_32){this.onDrop(_2f,_30,_31);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_33,_34,_35){if(this!=_33){this.onDropExternal(_33,_34,_35);}else{this.onDropInternal(_34,_35);}},onDropExternal:function(_36,_37,_38){var _39=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(_3a,_3b){return _39.call(this,_36.getItem(_3a.id).data,_3b);};}else{if(_38){this._normalizedCreator=function(_3c,_3d){var t=_36.getItem(_3c.id);var n=_3c.cloneNode(true);n.id=_1b.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(_3e,_3f){var t=_36.getItem(_3e.id);_36.delItem(_3e.id);return {node:_3e,data:t.data,type:t.type};};}}this.selectNone();if(!_38&&!this.creator){_36.selectNone();}this.insertNodes(true,_37,this.before,this.current);if(!_38&&this.creator){_36.deleteSelectedNodes();}this._normalizedCreator=_39;},onDropInternal:function(_40,_41){var _42=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(_41){if(this.creator){this._normalizedCreator=function(_43,_44){return _42.call(this,this.getItem(_43.id).data,_44);};}else{this._normalizedCreator=function(_45,_46){var t=this.getItem(_45.id);var n=_45.cloneNode(true);n.id=_1b.dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(_47,_48){var t=this.getItem(_47.id);return {node:_47,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_40,this.before,this.current);this._normalizedCreator=_42;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_1b.dnd.Source.superclass.onOverEvent.call(this);_1d.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_1b.dnd.Source.superclass.onOutEvent.call(this);_1d.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_49){if(this.current==this.targetAnchor&&this.before==_49){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_49;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(_4a){this._changeState("Source",_4a?"Copied":"Moved");},_legalMouseDown:function(e){if(!_1b.mouseButtons.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var _4b=e.target;_4b&&_4b!==this.node;_4b=_4b.parentNode){if(_1b.hasClass(_4b,"dojoDndHandle")){return true;}if(_1b.hasClass(_4b,"dojoDndItem")||_1b.hasClass(_4b,"dojoDndIgnore")){break;}}return false;}});});},"dojo/dnd/Container":function(){define("dojo/dnd/Container",["../main","../Evented","./common","../parser"],function(_4c,_4d){_4c.declare("dojo.dnd.Container",_4d,{skipForm:false,constructor:function(_4e,_4f){this.node=_4c.byId(_4e);if(!_4f){_4f={};}this.creator=_4f.creator||null;this.skipForm=_4f.skipForm;this.parent=_4f.dropParent&&_4c.byId(_4f.dropParent);this.map={};this.current=null;this.containerState="";_4c.addClass(this.node,"dojoDndContainer");if(!(_4f&&_4f._skipStartup)){this.startup();}this.events=[_4c.connect(this.node,"onmouseover",this,"onMouseOver"),_4c.connect(this.node,"onmouseout",this,"onMouseOut"),_4c.connect(this.node,"ondragstart",this,"onSelectStart"),_4c.connect(this.node,"onselectstart",this,"onSelectStart")];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,_50){this.map[key]=_50;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_4c.global;var m=this.map,e=_4c.dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _4c.query("> .dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(_51){if(_51.id){var _52=this.getItem(_51.id);if(_52){map[_51.id]=_52;return;}}else{_51.id=_4c.dnd.getUniqueId();}var _53=_51.getAttribute("dndType"),_54=_51.getAttribute("dndData");map[_51.id]={data:_54||_51.innerHTML,type:_53?_53.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(_55,_56,_57){if(!this.parent.firstChild){_57=null;}else{if(_56){if(!_57){_57=this.parent.firstChild;}}else{if(_57){_57=_57.nextSibling;}}}if(_57){for(var i=0;i<_55.length;++i){var t=this._normalizedCreator(_55[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.insertBefore(t.node,_57);}}else{for(var i=0;i<_55.length;++i){var t=this._normalizedCreator(_55[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_4c.forEach(this.events,_4c.disconnect);this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_58,_59,_5a){_58._skipStartup=true;return new _5a(_59,_58);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=_4c.dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!_4c.dnd.isFormElement(e)){_4c.stopEvent(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(_5b,_5c){var _5d="dojoDnd"+_5b;var _5e=_5b.toLowerCase()+"State";_4c.replaceClass(this.node,_5d+_5c,_5d+this[_5e]);this[_5e]=_5c;},_addItemClass:function(_5f,_60){_4c.addClass(_5f,"dojoDndItem"+_60);},_removeItemClass:function(_61,_62){_4c.removeClass(_61,"dojoDndItem"+_62);},_getChildByEvent:function(e){var _63=e.target;if(_63){for(var _64=_63.parentNode;_64;_63=_64,_64=_63.parentNode){if(_64==this.parent&&_4c.hasClass(_63,"dojoDndItem")){return _63;}}}return null;},_normalizedCreator:function(_65,_66){var t=(this.creator||this.defaultCreator).call(this,_65,_66);if(!_4c.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=_4c.dnd.getUniqueId();}_4c.addClass(t.node,"dojoDndItem");return t;}});_4c.dnd._createNode=function(tag){if(!tag){return _4c.dnd._createSpan;}return function(_67){return _4c.create(tag,{innerHTML:_67});};};_4c.dnd._createTrTd=function(_68){var tr=_4c.create("tr");_4c.create("td",{innerHTML:_68},tr);return tr;};_4c.dnd._createSpan=function(_69){return _4c.create("span",{innerHTML:_69});};_4c.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};_4c.dnd._defaultCreator=function(_6a){var tag=_6a.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?_4c.dnd._createTrTd:_4c.dnd._createNode(_4c.dnd._defaultCreatorNodes[tag]);return function(_6b,_6c){var _6d=_6b&&_4c.isObject(_6b),_6e,_6f,n;if(_6d&&_6b.tagName&&_6b.nodeType&&_6b.getAttribute){_6e=_6b.getAttribute("dndData")||_6b.innerHTML;_6f=_6b.getAttribute("dndType");_6f=_6f?_6f.split(/\s*,\s*/):["text"];n=_6b;}else{_6e=(_6d&&_6b.data)?_6b.data:_6b;_6f=(_6d&&_6b.type)?_6b.type:["text"];n=(_6c=="avatar"?_4c.dnd._createSpan:c)(String(_6e));}if(!n.id){n.id=_4c.dnd.getUniqueId();}return {node:n,data:_6e,type:_6f};};};return _4c.dnd.Container;});},"dojo/dnd/Manager":function(){define("dojo/dnd/Manager",["../main","../Evented","./common","./autoscroll","./Avatar"],function(_70,_71){var _72=_70.declare("dojo.dnd.Manager",[_71],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:16,OFFSET_Y:16,overSource:function(_73){if(this.avatar){this.target=(_73&&_73.targetState!="Disabled")?_73:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_70.publish("/dnd/source/over",[_73]);},outSource:function(_74){if(this.avatar){if(this.target==_74){this.target=null;this.canDropFlag=false;this.avatar.update();_70.publish("/dnd/source/over",[null]);}}else{_70.publish("/dnd/source/over",[null]);}},startDrag:function(_75,_76,_77){this.source=_75;this.nodes=_76;this.copy=Boolean(_77);this.avatar=this.makeAvatar();_70.body().appendChild(this.avatar.node);_70.publish("/dnd/start",[_75,_76,this.copy]);this.events=[_70.connect(_70.doc,"onmousemove",this,"onMouseMove"),_70.connect(_70.doc,"onmouseup",this,"onMouseUp"),_70.connect(_70.doc,"onkeydown",this,"onKeyDown"),_70.connect(_70.doc,"onkeyup",this,"onKeyUp"),_70.connect(_70.doc,"ondragstart",_70.stopEvent),_70.connect(_70.body(),"onselectstart",_70.stopEvent)];var c="dojoDnd"+(_77?"Copy":"Move");_70.addClass(_70.body(),c);},canDrop:function(_78){var _79=Boolean(this.target&&_78);if(this.canDropFlag!=_79){this.canDropFlag=_79;this.avatar.update();}},stopDrag:function(){_70.removeClass(_70.body(),["dojoDndCopy","dojoDndMove"]);_70.forEach(this.events,_70.disconnect);this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _70.dnd.Avatar(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_70.dnd.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var _7a=Boolean(this.source.copyState(_70.isCopyKey(e)));if(this.copy!=_7a){this._setCopyStatus(_7a);}}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var _7b=Boolean(this.source.copyState(_70.isCopyKey(e))),_7c=[this.source,this.nodes,_7b,this.target,e];_70.publish("/dnd/drop/before",_7c);_70.publish("/dnd/drop",_7c);}else{_70.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case _70.keys.CTRL:var _7d=Boolean(this.source.copyState(true));if(this.copy!=_7d){this._setCopyStatus(_7d);}break;case _70.keys.ESCAPE:_70.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==_70.keys.CTRL){var _7e=Boolean(this.source.copyState(false));if(this.copy!=_7e){this._setCopyStatus(_7e);}}},_setCopyStatus:function(_7f){this.copy=_7f;this.source._markDndStatus(this.copy);this.updateAvatar();_70.replaceClass(_70.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});_70.dnd._manager=null;_72.manager=_70.dnd.manager=function(){if(!_70.dnd._manager){_70.dnd._manager=new _70.dnd.Manager();}return _70.dnd._manager;};return _72;});},"dojo/dnd/Avatar":function(){define("dojo/dnd/Avatar",["../main","./common"],function(_80){_80.declare("dojo.dnd.Avatar",null,{constructor:function(_81){this.manager=_81;this.construct();},construct:function(){this.isA11y=_80.hasClass(_80.body(),"dijit_a11y");var a=_80.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_82=this.manager.source,_83,b=_80.create("tbody",null,a),tr=_80.create("tr",null,b),td=_80.create("td",null,tr),_84=this.isA11y?_80.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td):null,_85=_80.create("span",{innerHTML:_82.generateText?this._generateText():""},td),k=Math.min(5,this.manager.nodes.length),i=0;_80.attr(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_82.creator){_83=_82._normalizedCreator(_82.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{_83=this.manager.nodes[i].cloneNode(true);if(_83.tagName.toLowerCase()=="tr"){var _86=_80.create("table"),_87=_80.create("tbody",null,_86);_87.appendChild(_83);_83=_86;}}_83.id="";tr=_80.create("tr",null,b);td=_80.create("td",null,tr);td.appendChild(_83);_80.attr(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_80.destroy(this.node);this.node=false;},update:function(){_80[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");if(this.isA11y){var _88=_80.byId("a11yIcon");var _89="+";if(this.manager.canDropFlag&&!this.manager.copy){_89="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){_89="o";}else{if(!this.manager.canDropFlag){_89="x";}}}_88.innerHTML=_89;}_80.query(("tr.dojoDndAvatarHeader td span"+(this.isA11y?" span":"")),this.node).forEach(function(_8a){_8a.innerHTML=this._generateText();},this);},_generateText:function(){return this.manager.nodes.length.toString();}});return _80.dnd.Avatar;});},"*noref":1}});define("dojo/_dnd_basic",[],1);require(["dojo/dnd/common","dojo/dnd/Source","dojo/dnd/AutoSource","dojo/dnd/Target","dojo/dnd/Selector","dojo/dnd/Container","dojo/dnd/Manager","dojo/dnd/Avatar"]);